<!-- 🔍 Search Bar Container -->
<div class="search-bar-wrapper">
  <input
    type="text"
    [(ngModel)]="searchQuery"
    (input)="filterStages()"
    placeholder="Rechercher un stage..."
    class="search-input"
  />
</div>

<!-- Cartes -->
<div class="container">
  <div *ngIf="isLoading" class="loader">Chargement...</div>
  <div class="stage-cards-container" style="font-size: 1.4rem;">
    <div *ngFor="let stage of filteredStages" class="stage-card">
      <div class="card-content">
        <div class="header" style="display: flex; justify-content: space-between; align-items: center;">
          <h3 style="font-size: 1.6rem;">{{ stage.type }}</h3>
          <span class="badge" [ngClass]="{ paid: stage.payant, unpaid: !stage.payant }" style="font-size: 1.2rem; padding: 0.4rem 0.9rem;">
            {{ stage.payant ? 'Rémunéré' : 'Non rémunéré' }}
          </span> 
        </div>

        <div class="details" style="font-size: 1rem;">
          <p style="font-size: 1.4rem;"><strong>Domaine :</strong> {{ stage.domaine }}</p>
          <p style="font-size: 1.4rem;"><strong>Entreprise :</strong> {{ stage.entreprise }}</p>
          <p style="font-size: 1.4rem;"><strong>Début :</strong> {{ stage.dateDebut }}</p>
          <p style="font-size: 1.4rem;"><strong>Fin :</strong> {{ stage.dateFin }}</p>
        </div>

        <div class="action-buttons">
          <!-- Icône pour afficher les détails -->
          <button (click)="toggleDetails(stage.id!)" class="icon-button" title="Voir plus de détails">
            ➕
          </button>
        
          <!-- Icône pour afficher la localisation -->
          <button (click)="afficherMap(stage.entreprise)" class="icon-button" title="Voir la localisation de l'entreprise">
            📍
          </button>
        </div>
        

        <div *ngIf="expandedId === stage.id" class="extra-details">
          <p style="font-size: 1.4rem;"><strong>Email:</strong> {{ stage.email }}</p>
          <p style="font-size: 1.4rem;"><strong>Téléphone:</strong> {{ stage.phoneNumber }}</p>
          <p style="font-size: 1.4rem;"><strong>Description:</strong> {{ stage.description }}</p>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 🗺️ Modal pour afficher la carte -->
<div *ngIf="showMapModal" class="modal-overlay">
  <div class="modal-content">
    <button class="close-button" (click)="closeMapModal()">X</button>
    <h2>Localisation de l'entreprise</h2>

    <iframe
      width="100%"
      height="400"
      frameborder="0"
      [src]="mapUrl"
      allowfullscreen>
    </iframe>
  </div>
</div>
